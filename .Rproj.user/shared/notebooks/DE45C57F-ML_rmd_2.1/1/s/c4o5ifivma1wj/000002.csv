"0","boxcox <- function(x, lambda = 1) {"
"0","   "
"0","   (x^(lambda) - 1 /"
"0","       (lambda))"
"0","   "
"0","}"
"0","box_grobs_2 <- list()"
"0","box_grobs_higher <- list()"
"0","for (i in 1:length(seq(0.025, 0.3, 0.025))) {"
"0","   "
"0","   j <- seq(0.025, 0.3, 0.025)[i]"
"0","   "
"0","   boxcox_price <- mutate(advertising_train,"
"0","                          ""bc_price1"" = boxcox(x = price1,"
"0","                                               lambda = j),"
"0","                          ""bc_price2"" = boxcox(x = price2,"
"0","                                               lambda = j),"
"0","                          ""bc_price3"" = boxcox(x = price3,"
"0","                                               lambda = j))"
"0","   "
"0","   bc_colnames <- colnames(boxcox_price)[str_detect(colnames(boxcox_price), ""bc_price"")]"
"0","   "
"0","   for (k in bc_colnames) {"
"0","      "
"0","      m <- which(bc_colnames %in% k)"
"0","      "
"0","      box_grobs_2[[m]] <- ggplot(select(boxcox_price,"
"0","                                        k, deviceType)) +"
"0","         geom_density(aes(x = .data[[k]], fill = deviceType),"
"0","                      alpha = 1/3) +"
"0","         labs(title = paste(""Lambda = "", j)) +"
"0","         ylab(""Density"") + xlab(k) +"
"0","         theme_minimal() +"
"0","         theme(panel.grid.major.x = element_blank(),"
"0","               panel.grid.minor.x = element_blank())"
"0","      "
"0","   }"
"0","   "
"0","   box_grobs_higher[[i]] <- box_grobs_2"
"0","   "
"0","}"
"0","density_by_lambda <- list()"
"0","for (i in 1:12) {"
"0","   "
"0","   density_by_lambda[[i]] <-  do.call(what = grid.arrange,"
"0","                                      args = list(grobs = box_grobs_higher[[i]],"
"0","                                                  nrow = 1))"
"0","   "
"0","} "
